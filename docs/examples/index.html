<!doctype html><html><head><style>body {max-width: 40em; margin: .5in auto;}
h1,h2,h3,h4,h5,h6 {font-family: Helvetica;}
a {color: #1a6e8e}
pre, code {font-size: 16px; word-wrap: break-word;}
pre.sourceCode span.st {color: #366354}
pre.sourceCode span.kw {color: #397460}
pre.sourceCode span.fu {color: #8f4e8b}
pre.sourceCode span.ot {color: #2e659c}
pre.sourceCode span.dt {color: #4F4371}
pre.sourceCode span.co {color: #666}

@media(max-width:767px){
    body { margin: 1px 4px; }
    h1, h2, .menu { margin: 0; }
    h1 { font-size: 1.5em; }
    h2 { font-size: 1.125em; }
    h3 { font-size: 1.0125em; }
 }

li { line-height: 2em }
</style></head><body><h1>Hell examples</h1><p><a href='../'>Back to homepage</a></p><h2>01-hello-world.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#!/usr/bin/env hell</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> Text.putStrLn <span class="st">&quot;Hello, World!&quot;</span></span></code></pre></div>
<h2>02-interaction.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn <span class="st">&quot;Please enter your name and hit ENTER:&quot;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  name <span class="ot">&lt;-</span> Text.getLine</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn <span class="st">&quot;Thanks, your name is: &quot;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn name</span></code></pre></div>
<h2>03-press-any-key.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">IO</span><span class="op">.</span>hSetBuffering <span class="dt">IO</span><span class="op">.</span>stdin <span class="dt">IO</span><span class="op">.</span><span class="dt">NoBuffering</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">IO</span><span class="op">.</span>hSetBuffering <span class="dt">IO</span><span class="op">.</span>stdout <span class="dt">IO</span><span class="op">.</span><span class="dt">NoBuffering</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  Text.putStr <span class="st">&quot;Please press any key ... &quot;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  chunk <span class="ot">&lt;-</span> <span class="dt">ByteString</span><span class="op">.</span>hGet <span class="dt">IO</span><span class="op">.</span>stdin <span class="dv">1</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">IO</span><span class="op">.</span>hSetBuffering <span class="dt">IO</span><span class="op">.</span>stdout <span class="dt">IO</span><span class="op">.</span><span class="dt">LineBuffering</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn <span class="st">&quot;OK!&quot;</span></span></code></pre></div>
<h2>04-writing-files.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> fp <span class="ot">=</span> <span class="st">&quot;foo.txt&quot;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  Text.writeFile fp <span class="st">&quot;Hello, &quot;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  Text.appendFile fp <span class="st">&quot;World!&quot;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  text <span class="ot">&lt;-</span> Text.readFile fp</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn text</span></code></pre></div>
<h2>05-lists.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> is <span class="ot">=</span> List.iterate&#39; (<span class="dt">Int</span><span class="op">.</span>plus <span class="dv">1</span>) <span class="dv">0</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> xs <span class="ot">=</span> [<span class="st">&quot;Hello, &quot;</span>, <span class="st">&quot;World!&quot;</span>]</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn <span class="st">&quot;OK!&quot;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Monad</span><span class="op">.</span>forM_ (List.zip is xs) \(i,x) <span class="ot">-&gt;</span> <span class="kw">do</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">IO</span><span class="op">.</span><span class="fu">print</span> i</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    Text.putStrLn x</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">IO</span><span class="op">.</span><span class="fu">print</span> <span class="op">$</span> List.foldl&#39; <span class="dt">Int</span><span class="op">.</span>plus <span class="dv">0</span> <span class="op">$</span> List.take <span class="dv">10</span> is</span></code></pre></div>
<h2>06-polymorphism.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> x <span class="ot">=</span> <span class="st">&quot;Hello!&quot;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn (Function.id x)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> lengths <span class="ot">=</span> List.map Text.length [<span class="st">&quot;foo&quot;</span>, <span class="st">&quot;mu&quot;</span>]</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">IO</span><span class="op">.</span><span class="fu">mapM_</span> (\i <span class="ot">-&gt;</span> Text.putStrLn (<span class="dt">Int</span><span class="op">.</span><span class="fu">show</span> i)) lengths</span></code></pre></div>
<h2>07-loops.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">IO</span><span class="op">.</span><span class="fu">mapM_</span> Text.putStrLn [<span class="st">&quot;Hello, &quot;</span>, <span class="st">&quot;World!&quot;</span>]</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  Function.fix (\(<span class="ot">loop ::</span> <span class="dt">IO</span> ()) <span class="ot">-&gt;</span> <span class="kw">do</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    Text.putStrLn <span class="st">&quot;Ahhhhh! More?&quot;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    l <span class="ot">&lt;-</span> Text.getLine</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    loop)</span></code></pre></div>
<h2>08-tuples.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> demo <span class="ot">=</span> \(x, y) <span class="ot">-&gt;</span> y</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> foobar <span class="ot">=</span> (<span class="dv">123</span>, <span class="st">&quot;foo&quot;</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn (demo foobar)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> (foo,bar) <span class="ot">=</span> (<span class="dv">123</span>, <span class="st">&quot;foo&quot;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn bar</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Monad</span><span class="op">.</span><span class="fu">return</span> ()</span></code></pre></div>
<h2>09-processes.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn <span class="st">&quot;OK&quot;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  (code, out, err) <span class="ot">&lt;-</span> <span class="dt">ByteString</span><span class="op">.</span>readProcess (Process.proc <span class="st">&quot;ls&quot;</span> [<span class="st">&quot;-al&quot;</span>])</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">ByteString</span><span class="op">.</span>hPutStr <span class="dt">IO</span><span class="op">.</span>stdout out</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">ByteString</span><span class="op">.</span>hPutStr <span class="dt">IO</span><span class="op">.</span>stdout err</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  (out, err) <span class="ot">&lt;-</span> Text.readProcess_ (Process.proc <span class="st">&quot;df&quot;</span> [<span class="st">&quot;-h&quot;</span>, <span class="st">&quot;/&quot;</span>])</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  Text.hPutStr <span class="dt">IO</span><span class="op">.</span>stdout out</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  Text.hPutStr <span class="dt">IO</span><span class="op">.</span>stdout err</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  code <span class="ot">&lt;-</span> Process.runProcess (Process.proc <span class="st">&quot;false&quot;</span> [])</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  Process.runProcess_ (Process.proc <span class="st">&quot;echo&quot;</span> [<span class="st">&quot;Hello, World!&quot;</span>])</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Explicit type signature, but you don&#39;t need this. Just for demo&#39;ing.</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> config <span class="ot">=</span> Process.proc <span class="st">&quot;false&quot;</span> []</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  code <span class="ot">&lt;-</span> Process.runProcess config</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn <span class="st">&quot;Done.&quot;</span></span></code></pre></div>
<h2>10-current-directory.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  dir <span class="ot">&lt;-</span> Directory.getCurrentDirectory</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn dir</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  Directory.setCurrentDirectory dir</span></code></pre></div>
<h2>11-env-vars.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  env <span class="ot">&lt;-</span> Environment.getEnvironment</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  (out, err) <span class="ot">&lt;-</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    Text.readProcess_ (</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>      Process.setEnv (List.cons (<span class="st">&quot;HELL_DEMO&quot;</span>, <span class="st">&quot;wibble&quot;</span>) env)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        (Process.proc <span class="st">&quot;env&quot;</span> [])</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  Text.hPutStr <span class="dt">IO</span><span class="op">.</span>stdout out</span></code></pre></div>
<h2>12-fib.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn (<span class="dt">Int</span><span class="op">.</span><span class="fu">show</span> (Main.fib <span class="dv">30</span>))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>fib <span class="ot">=</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  Function.fix</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    (\fib i <span class="ot">-&gt;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Bool</span><span class="op">.</span>bool</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        (<span class="dt">Bool</span><span class="op">.</span>bool</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>           (<span class="dt">Int</span><span class="op">.</span>plus (fib (<span class="dt">Int</span><span class="op">.</span><span class="fu">subtract</span> <span class="dv">1</span> i))</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                     (fib (<span class="dt">Int</span><span class="op">.</span><span class="fu">subtract</span> <span class="dv">2</span> i)))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>           <span class="dv">1</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>           (<span class="dt">Int</span><span class="op">.</span>eq i <span class="dv">1</span>))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        (<span class="dt">Int</span><span class="op">.</span>eq i <span class="dv">0</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<h2>13-concurrency.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Run two things concurrently and return both results</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  (left, right) <span class="ot">&lt;-</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    Async.concurrently</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>       (Main.curl <span class="st">&quot;https://worldtimeapi.org/api/timezone/Europe/London&quot;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>       (Main.curl <span class="st">&quot;https://worldtimeapi.org/api/timezone/Europe/Rome&quot;</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn left</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn right</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Run two things concurrently and return the one that completes first</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    Async.race</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>       (Main.curl <span class="st">&quot;https://worldtimeapi.org/api/timezone/Europe/London&quot;</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>       (Main.curl <span class="st">&quot;https://worldtimeapi.org/api/timezone/Europe/Rome&quot;</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Either</span><span class="op">.</span><span class="fu">either</span> Text.putStrLn Text.putStrLn result</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>curl <span class="ot">=</span> \url <span class="ot">-&gt;</span> <span class="kw">do</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  (out, err) <span class="ot">&lt;-</span> Text.readProcess_ (Process.proc <span class="st">&quot;curl&quot;</span> [url])</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="dt">IO</span><span class="op">.</span><span class="fu">pure</span> out</span></code></pre></div>
<h2>14-text.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn (Text.concat [<span class="st">&quot;Hello, &quot;</span>, <span class="st">&quot;World!&quot;</span>])</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn (Text.take <span class="dv">3</span> <span class="st">&quot;Hello, World!&quot;</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn (Text.drop <span class="dv">3</span> <span class="st">&quot;Hello, World!&quot;</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn (Text.strip <span class="st">&quot;  Hello, World!   &quot;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn (Text.intercalate <span class="st">&quot;, &quot;</span> [<span class="st">&quot;Hello&quot;</span>,<span class="st">&quot;World!&quot;</span>])</span></code></pre></div>
<h2>15-type-classes.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn (<span class="dt">Show</span><span class="op">.</span><span class="fu">show</span> <span class="dv">123</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn (<span class="dt">Show</span><span class="op">.</span><span class="fu">show</span> <span class="dt">Bool</span><span class="op">.</span><span class="dt">True</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  env <span class="ot">&lt;-</span> Environment.getEnvironment</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Maybe</span><span class="op">.</span><span class="fu">maybe</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    (Text.putStrLn <span class="st">&quot;Seems the environment variable is not there.&quot;</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    (\path <span class="ot">-&gt;</span> Text.putStrLn (Text.concat [<span class="st">&quot;HOME is &quot;</span>, path]))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    (List.lookup <span class="st">&quot;HOME&quot;</span> env)</span></code></pre></div>
<h2>16-if.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> List.and [<span class="dt">Eq</span><span class="op">.</span>eq (<span class="dt">Int</span><span class="op">.</span>plus <span class="dv">1</span> <span class="dv">1</span>) <span class="dv">2</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               <span class="dt">Ord</span><span class="op">.</span>lt (<span class="dt">Int</span><span class="op">.</span>plus <span class="dv">1</span> <span class="dv">1</span>) <span class="dv">3</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               <span class="dt">Eq</span><span class="op">.</span>eq (Text.concat [<span class="st">&quot;Hello, World!&quot;</span>]) <span class="st">&quot;Hello, World!&quot;</span>]</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>     <span class="kw">then</span> Text.putStrLn <span class="st">&quot;OK, List.and works.&quot;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>     <span class="kw">else</span> Text.putStrLn <span class="st">&quot;Uh, oh?&quot;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> List.or [<span class="dt">Eq</span><span class="op">.</span>eq <span class="dv">1</span> <span class="dv">2</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>              <span class="dt">Eq</span><span class="op">.</span>eq <span class="st">&quot;x&quot;</span> <span class="st">&quot;x&quot;</span>]</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>     <span class="kw">then</span> Text.putStrLn <span class="st">&quot;OK, List.or works.&quot;</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>     <span class="kw">else</span> Text.putStrLn <span class="st">&quot;Uh, oh?&quot;</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> <span class="dt">Bool</span><span class="op">.</span><span class="fu">not</span> (<span class="dt">Eq</span><span class="op">.</span>eq <span class="dv">1</span> <span class="dv">2</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>     <span class="kw">then</span> Text.putStrLn <span class="st">&quot;OK, Bool.not works.&quot;</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>     <span class="kw">else</span> Text.putStrLn <span class="st">&quot;Uh, oh?&quot;</span></span></code></pre></div>
<h2>17-reuse.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Technically you&#39;re not supposed to be able to do code re-use in</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- Hell, but presently the desugarer inlines everything into `main`</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">-- prior to type-checking, and ignores declarations that aren&#39;t</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">-- reachable by main.</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  Main.foo <span class="dv">1</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  Main.foo <span class="st">&quot;blah&quot;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">=</span> \x <span class="ot">-&gt;</span> Text.putStrLn (<span class="dt">Show</span><span class="op">.</span><span class="fu">show</span> x)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>bar <span class="ot">=</span> <span class="dt">Int</span><span class="op">.</span>plus <span class="dv">4</span> <span class="st">&quot;hi&quot;</span></span></code></pre></div>
<h2>18-monads.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  env <span class="ot">&lt;-</span> Environment.getEnvironment</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Maybe monad works!</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Maybe</span><span class="op">.</span><span class="fu">maybe</span> (Text.putStrLn <span class="st">&quot;Oops!&quot;</span>) Text.putStrLn</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>     (<span class="kw">do</span> path <span class="ot">&lt;-</span> List.lookup <span class="st">&quot;PATH&quot;</span> env</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>         home <span class="ot">&lt;-</span> List.lookup <span class="st">&quot;HOME&quot;</span> env</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>         <span class="dt">Monad</span><span class="op">.</span><span class="fu">return</span> (Text.concat [path, <span class="st">&quot; and &quot;</span>, home]))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Either monad works!</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Either</span><span class="op">.</span><span class="fu">either</span> Text.putStrLn Text.putStrLn</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">do</span> x <span class="ot">&lt;-</span> Main.parse <span class="st">&quot;foo&quot;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        y <span class="ot">&lt;-</span> Main.parse <span class="st">&quot;foo&quot;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">Monad</span><span class="op">.</span><span class="fu">return</span> (Text.concat [x,y]))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>parse <span class="ot">=</span> \s <span class="ot">-&gt;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> <span class="dt">Eq</span><span class="op">.</span>eq s <span class="st">&quot;foo&quot;</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>     <span class="kw">then</span> <span class="dt">Either</span><span class="op">.</span><span class="dt">Right</span> <span class="st">&quot;foooo :-)&quot;</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>     <span class="kw">else</span> <span class="dt">Either</span><span class="op">.</span><span class="dt">Left</span> <span class="st">&quot;oh noes!&quot;</span></span></code></pre></div>
<h2>19-blog-generator.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- This is a copy of the script that generates my blog.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">-- Dependencies:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">--</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">-- hell-2024-02-07</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">-- pandoc-3.1.11.1</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">-- Main entry point just generates the complete blog every time.</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">--</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">--</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> Main.generate</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">-- The posts are listed under ./posts in this format:</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">--</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">-- dijkstra-haskell-java.markdown</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">-- reasoning-violently.md</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">-- god-mode.markdown</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">-- emacs-mail.markdown</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">--</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">-- .md or .markdown files, the extension doesn&#39;t matter.</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">--</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>generate <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  posts <span class="ot">&lt;-</span> Main.generatePosts</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  Main.generateArchive posts</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  Main.generateRSS posts</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co">-- Write out posts/$post/index.html per $post.</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co">--</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>generatePosts <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  posts <span class="ot">&lt;-</span> Directory.listDirectory <span class="st">&quot;posts&quot;</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn <span class="op">$</span> Text.concat [<span class="st">&quot;Generating &quot;</span>, <span class="dt">Show</span><span class="op">.</span><span class="fu">show</span> (List.length posts), <span class="st">&quot; posts ...&quot;</span>]</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  Async.pooledForConcurrently posts \post <span class="ot">-&gt;</span> <span class="kw">do</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    contents <span class="ot">&lt;-</span> Text.readFile <span class="op">$</span> Text.concat [<span class="st">&quot;posts/&quot;</span>, post]</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Maybe</span><span class="op">.</span><span class="fu">maybe</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>      (Error.error <span class="st">&quot;Couldn&#39;t parse the article!&quot;</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>      (\(date, title) <span class="ot">-&gt;</span> <span class="kw">do</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>        rendered <span class="ot">&lt;-</span> Main.render post</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>        <span class="dt">Monad</span><span class="op">.</span><span class="fu">return</span> (post, date, title, rendered))</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>      <span class="op">$</span> Main.parse contents</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="co">-- Generate the /posts/ page.</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co">--</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>generateArchive <span class="ot">=</span> \posts <span class="ot">-&gt;</span> <span class="kw">do</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn <span class="st">&quot;Generating archive ...&quot;</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> rows <span class="ot">=</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>        Text.concat</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>          <span class="op">$</span> List.map</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>            (\(post, date, title, content) <span class="ot">-&gt;</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>              Text.concat [</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;&lt;tr&gt;&lt;td&gt;&lt;a href=&#39;&quot;</span>,</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>                 Main.filename post,</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;&#39;&gt;&quot;</span>,</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>                 Main.strip title,</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span>,</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>                 date,</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>               ])</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>            <span class="op">$</span> List.reverse</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>            <span class="op">$</span> List.sortOn (\(post, date, title, content) <span class="ot">-&gt;</span> date)</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>            <span class="op">$</span> posts</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> table <span class="ot">=</span> Text.concat [</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;---\n&quot;</span>,</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;title: Archive\n&quot;</span>,</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;---\n&quot;</span>,</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&lt;table id=&#39;archive&#39; style=&#39;line-height:2em&#39;&gt;&quot;</span>,</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>        rows,</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&lt;/table&gt;&quot;</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  (out, err) <span class="ot">&lt;-</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    Text.readProcess_</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>      <span class="op">$</span> Text.setStdin table</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>      <span class="op">$</span> Process.proc <span class="st">&quot;pandoc&quot;</span> [<span class="st">&quot;--standalone&quot;</span>,<span class="st">&quot;--template&quot;</span>,<span class="st">&quot;templates/posts.html&quot;</span>]</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  Text.writeFile <span class="st">&quot;webroot/posts/index.html&quot;</span> out</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="co">-- Contents of an article looks like this:</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="co">--</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a><span class="co">-- ---</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="co">-- date: 2011-04-10</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="co">-- title: ‘amb’ operator and the list monad</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a><span class="co">-- description: ‘amb’ operator and the list monad</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a><span class="co">-- author: Chris Done</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a><span class="co">-- tags: haskell, designs</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a><span class="co">-- ---</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a><span class="co">--</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a><span class="co">-- We&#39;re only interested in the date and the title. The rest is</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a><span class="co">-- redundant.</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a><span class="co">--</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>parse <span class="ot">=</span> \article <span class="ot">-&gt;</span> <span class="kw">do</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>  sansPrefix <span class="ot">&lt;-</span> Text.stripPrefix <span class="st">&quot;---&quot;</span> article</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> (preamble, _content) <span class="ot">=</span> Text.breakOn <span class="st">&quot;---&quot;</span> sansPrefix</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> <span class="fu">lines</span> <span class="ot">=</span> Text.splitOn <span class="st">&quot;\n&quot;</span> preamble</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> pairs <span class="ot">=</span> List.map (\line <span class="ot">-&gt;</span> <span class="kw">do</span> <span class="kw">let</span> (key, value) <span class="ot">=</span> Text.breakOn <span class="st">&quot;:&quot;</span> line</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>                                    (key, Text.strip (Text.drop <span class="dv">1</span> value)))</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">lines</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>  date <span class="ot">&lt;-</span> List.lookup <span class="st">&quot;date&quot;</span> pairs</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>  title <span class="ot">&lt;-</span> List.lookup <span class="st">&quot;title&quot;</span> pairs</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Monad</span><span class="op">.</span><span class="fu">return</span> (date, title)</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a><span class="co">-- A post consists of a date, title and markdown.</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a><span class="co">--</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a><span class="co">-- Rendering them is easy, just run pandoc and apply an HTML template.</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>render <span class="ot">=</span> \post <span class="ot">-&gt;</span> <span class="kw">do</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> targetDir <span class="ot">=</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>        Text.concat [<span class="st">&quot;webroot/posts/&quot;</span>, Main.filename post]</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> targetFile <span class="ot">=</span> Text.concat [targetDir, <span class="st">&quot;/index.html&quot;</span>]</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>  (out, err) <span class="ot">&lt;-</span> Text.readProcess_ (Process.proc <span class="st">&quot;pandoc&quot;</span> [<span class="st">&quot;--standalone&quot;</span>,<span class="st">&quot;--template&quot;</span>,<span class="st">&quot;templates/post.html&quot;</span>,Text.concat [<span class="st">&quot;posts/&quot;</span>, post]])</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>  Directory.createDirectoryIfMissing <span class="dt">Bool</span><span class="op">.</span><span class="dt">True</span> targetDir</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>  Text.writeFile targetFile out</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Monad</span><span class="op">.</span><span class="fu">return</span> out</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a><span class="co">-- Filename stripped of .md/.markdown.</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>filename <span class="ot">=</span> \post <span class="ot">-&gt;</span> Text.replace <span class="st">&quot;.md&quot;</span> <span class="st">&quot;&quot;</span> (Text.replace <span class="st">&quot;.markdown&quot;</span> <span class="st">&quot;&quot;</span> post)</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a><span class="co">-- Strip out quotes from &quot;foo&quot;.</span></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>strip <span class="ot">=</span> \title <span class="ot">-&gt;</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Maybe</span><span class="op">.</span><span class="fu">maybe</span> title Function.id <span class="kw">do</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>    title&#39; <span class="ot">&lt;-</span> Text.stripPrefix <span class="st">&quot;\&quot;&quot;</span> title</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>    Text.stripSuffix <span class="st">&quot;\&quot;&quot;</span> title&#39;</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a><span class="co">-- Generate the /rss.xml page.</span></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a><span class="co">--</span></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>generateRSS <span class="ot">=</span> \posts0 <span class="ot">-&gt;</span> <span class="kw">do</span></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> posts1 <span class="ot">=</span> List.reverse <span class="op">$</span> List.sortOn (\(post, date, title, content) <span class="ot">-&gt;</span> date) posts0</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>  posts <span class="ot">&lt;-</span> <span class="dt">Monad</span><span class="op">.</span>forM posts1 \(post, date, title, content) <span class="ot">-&gt;</span> <span class="kw">do</span></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>    date&#39; <span class="ot">&lt;-</span> Text.readProcessStdout_ <span class="op">$</span> Text.setStdin date <span class="op">$</span> Process.proc <span class="st">&quot;date&quot;</span> [<span class="st">&quot;-R&quot;</span>, <span class="st">&quot;-f&quot;</span>, <span class="st">&quot;/dev/stdin&quot;</span>]</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Monad</span><span class="op">.</span><span class="fu">return</span> (post, date&#39;, title, content)</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn <span class="st">&quot;Generating rss.xml ...&quot;</span></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> items <span class="ot">=</span></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>        Text.unlines</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>          <span class="op">$</span> List.map</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>            (\(post, date, title, content) <span class="ot">-&gt;</span></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>              Text.concat [</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;&lt;item&gt;&quot;</span>,</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;&lt;title&gt;&lt;![CDATA[&quot;</span>, Main.strip title, <span class="st">&quot;]]&gt;&lt;/title&gt;&quot;</span>,</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;&lt;link&gt;https://chrisdone.com/posts/&quot;</span>, Main.filename post, <span class="st">&quot;&lt;/link&gt;&quot;</span>,</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;&lt;guid&gt;https://chrisdone.com/posts/&quot;</span>, Main.filename post, <span class="st">&quot;&lt;/guid&gt;&quot;</span>,</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;&lt;description&gt;&lt;![CDATA[&quot;</span>, content, <span class="st">&quot;]]&gt;&lt;/description&gt;&quot;</span>,</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;&lt;pubDate&gt;&quot;</span>, date, <span class="st">&quot;&lt;/pubDate&gt;&quot;</span>,</span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;&lt;dc:creator&gt;Chris Done&lt;/dc:creator&gt;&quot;</span>,</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;&lt;/item&gt;&quot;</span></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>               ])</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>            posts</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> xml <span class="ot">=</span> Text.unlines [</span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;utf-8\&quot;?&gt;&quot;</span>,</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&lt;rss version=\&quot;2.0\&quot; xmlns:atom=\&quot;http://www.w3.org/2005/Atom\&quot; xmlns:dc=\&quot;http://purl.org/dc/elements/1.1/\&quot;&gt;&quot;</span>,</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&lt;channel&gt;&quot;</span>,</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&lt;title&gt;Chris Done&#39;s Blog&lt;/title&gt;&quot;</span>,</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&lt;link&gt;https://chrisdone.com&lt;/link&gt;&quot;</span>,</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&lt;description&gt;&lt;![CDATA[Blog all about programming, especially in Haskell since 2008!]]&gt;&lt;/description&gt;&quot;</span>,</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&lt;atom:link href=\&quot;https://chrisdone.com/rss.xml\&quot; rel=\&quot;self\&quot; type=\&quot;application/rss+xml\&quot; /&gt;&quot;</span>,</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&lt;lastBuildDate&gt;Wed, 22 Dec 2021 00:00:00 UT&lt;/lastBuildDate&gt;&quot;</span>,</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>        items,</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&lt;/channel&gt;&quot;</span>,</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&lt;/rss&gt;&quot;</span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>  Text.writeFile <span class="st">&quot;webroot/rss.xml&quot;</span> xml</span></code></pre></div>
<h2>20-dollar.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> Text.putStrLn <span class="op">.</span> Text.reverse <span class="op">$</span> <span class="st">&quot;Foo!&quot;</span></span></code></pre></div>
<h2>21-json.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">ByteString</span><span class="op">.</span><span class="fu">writeFile</span> <span class="st">&quot;demo.json&quot;</span> <span class="op">$</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    Json.encode <span class="op">$</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Json.Object</span> <span class="op">$</span> Map.fromList [</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;name&quot;</span>, <span class="dt">Json.String</span> <span class="st">&quot;Chris&quot;</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;age&quot;</span>, <span class="dt">Json.Number</span> <span class="fl">99.123</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>       ]</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  bytes <span class="ot">&lt;-</span> <span class="dt">ByteString</span><span class="op">.</span><span class="fu">readFile</span> <span class="st">&quot;demo.json&quot;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">ByteString</span><span class="op">.</span>hPutStr <span class="dt">IO</span><span class="op">.</span>stdout bytes</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn <span class="op">$</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Maybe</span><span class="op">.</span><span class="fu">maybe</span> <span class="st">&quot;Bad parse.&quot;</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>      (Json.value</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;null&quot;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        (\str <span class="ot">-&gt;</span> Text.concat [<span class="st">&quot;bool&quot;</span>, <span class="dt">Show</span><span class="op">.</span><span class="fu">show</span> str])</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        (\str <span class="ot">-&gt;</span> Text.concat [<span class="st">&quot;str&quot;</span>, <span class="dt">Show</span><span class="op">.</span><span class="fu">show</span> str])</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        (\dub <span class="ot">-&gt;</span> Text.concat [<span class="st">&quot;dub&quot;</span>, <span class="dt">Show</span><span class="op">.</span><span class="fu">show</span> dub])</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        (\arr <span class="ot">-&gt;</span> <span class="st">&quot;Array!&quot;</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        (\obj <span class="ot">-&gt;</span> <span class="st">&quot;Object.&quot;</span>))</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>       <span class="op">$</span> Json.decode bytes</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  Directory.removeFile <span class="st">&quot;demo.json&quot;</span></span></code></pre></div>
<h2>22-records.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> <span class="dt">Person</span> <span class="ot">=</span> <span class="dt">Person</span> {<span class="ot"> age ::</span> <span class="dt">Int</span>,<span class="ot"> name ::</span> <span class="dt">Text</span> }</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn <span class="op">$</span> Record.get <span class="op">@</span><span class="st">&quot;name&quot;</span> Main.person</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn <span class="op">$</span> Record.get <span class="op">@</span><span class="st">&quot;name&quot;</span> <span class="op">$</span> Record.set <span class="op">@</span><span class="st">&quot;name&quot;</span> <span class="st">&quot;Mary&quot;</span> Main.person</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  Text.putStrLn <span class="op">$</span> Record.get <span class="op">@</span><span class="st">&quot;name&quot;</span> <span class="op">$</span> Record.modify <span class="op">@</span><span class="st">&quot;name&quot;</span> Text.reverse Main.person</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>person <span class="ot">=</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a> <span class="dt">Main.Person</span> { name <span class="ot">=</span> <span class="st">&quot;Chris&quot;</span>, age <span class="ot">=</span> <span class="dv">23</span> }</span></code></pre></div>
<h2>23-args.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  args <span class="ot">&lt;-</span> Environment.getArgs</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Monad</span><span class="op">.</span>forM_ args <span class="dt">IO</span><span class="op">.</span><span class="fu">print</span></span></code></pre></div>
<h2>24-exitcode.hell</h2><div class="sourceCode" id="cb1"><pre
class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  (code, out, err) <span class="ot">&lt;-</span> <span class="dt">ByteString</span><span class="op">.</span>readProcess (Process.proc <span class="st">&quot;ls&quot;</span> [<span class="st">&quot;-al&quot;</span>])</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Accessor style</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  Exit.exitCode</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    (Text.putStrLn <span class="st">&quot;All good!&quot;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    (\i <span class="ot">-&gt;</span> <span class="dt">IO</span><span class="op">.</span><span class="fu">print</span> i)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    code</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Validation style</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if</span> <span class="dt">Eq</span><span class="op">.</span>eq code <span class="dt">Exit.ExitSuccess</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>     <span class="kw">then</span> Text.putStrLn <span class="st">&quot;OK, good!&quot;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>     <span class="kw">else</span> Text.putStrLn <span class="st">&quot;Oh, sad.&quot;</span></span></code></pre></div>
</html>